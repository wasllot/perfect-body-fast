(()=>{"use strict";var e,t,n,a,o,d,r,c,s,i,u,l=!1,v={id:"",uId:"",eventName:"",patientName:"",eventDescription:"",eventStatus:"",startDate:"",endDate:"",amount:0,service:"",doctorName:""};$(document).ready((function(){m(),p()}));var m=function(){var e=document.getElementById("appointmentCalendar");(t=new FullCalendar.Calendar(e,{navLinks:!0,selectable:!0,selectMirror:!0,editable:!1,dayMaxEvents:!0,displayEventTime:!1,buttonText:{month:"Month"},headerToolbar:{left:"prev,next",center:"title",right:"dayGridMonth"},events:function(e,t,n){$.ajax({url:route("appointments.calendar"),type:"GET",data:e,success:function(e){e.success&&t(e.data)},error:function(e){displayErrorMessage(e.responseJSON.message),n()}})},eventMouseEnter:function(e){S({id:e.event.id,title:e.event.title,startStr:e.event.startStr,endStr:e.event.endStr,patient:e.event.extendedProps.patient,status:e.event.extendedProps.status,amount:e.event.extendedProps.amount,uId:e.event.extendedProps.uId,service:e.event.extendedProps.service,doctorName:e.event.extendedProps.doctorName}),f(e.el)},eventMouseLeave:function(){h()},eventClick:function(e){h(),S({id:e.event.id,title:e.event.title,startStr:e.event.startStr,endStr:e.event.endStr,patient:e.event.extendedProps.patient,status:e.event.extendedProps.status,amount:e.event.extendedProps.amount,uId:e.event.extendedProps.uId,service:e.event.extendedProps.service,doctorName:e.event.extendedProps.doctorName}),M()}})).render()},p=function(){var e=document.getElementById("eventModal");c=new bootstrap.Modal(e),n=e.querySelector('[data-kt-calendar="event_name"]'),d=e.querySelector('[data-kt-calendar="event_patient_name"]'),e.querySelector('[data-kt-calendar="event_description"]'),a=e.querySelector('[data-kt-calendar="event_status"]'),u=e.querySelector('[data-kt-calendar="event_amount"]'),i=e.querySelector('[data-kt-calendar="event_uId"]'),s=e.querySelector('[data-kt-calendar="event_service"]'),o=e.querySelector('[data-kt-calendar="event_start_date"]'),r=e.querySelector('[data-kt-calendar="event_end_date"]'),e.querySelector("#kt_modal_view_event_edit"),e.querySelector("#kt_modal_view_event_delete")},S=function(e){v.id=e.id,v.eventName=e.title,v.patientName=e.patient,v.eventDescription=e.description,v.eventStatus=e.status,v.startDate=e.startStr,v.endDate=e.endStr,v.amount=e.amount,v.uId=e.uId,v.service=e.service,v.doctorName=e.doctorName},f=function(t){h();var n=v.allDay?moment(v.startDate).format("Do MMM, YYYY"):moment(v.startDate).format("Do MMM, YYYY - h:mm a"),a=v.allDay?moment(v.endDate).format("Do MMM, YYYY"):moment(v.endDate).format("Do MMM, YYYY - h:mm a"),o={container:"body",trigger:"manual",boundary:"window",placement:"auto",dismiss:!0,html:!0,title:"Appointment Details",content:'<div class="fw-bolder mb-2"><b>Doctor</b>: '+v.doctorName+'<div class="fw-bolder mb-2"><b>Patient</b>: '+v.patientName+'</div><div class="fs-7"><span class="fw-bold">Start:</span> '+n+'</div><div class="fs-7 mb-4"><span class="fw-bold">End:</span> '+a+"</div>"};(e=KTApp.initBootstrapPopover(t,o)).show(),l=!0},h=function(){l&&(e.dispose(),l=!1)},M=function(){var e,t;$(".fc-popover").addClass("hide"),c.show(),e=moment(v.startDate).format("Do MMM, YYYY - h:mm a"),t=moment(v.endDate).format("Do MMM, YYYY - h:mm a"),r.innerText=": "+t,o.innerText=": "+e,n.innerText="Doctor: "+v.doctorName,d.innerText="Patient: "+v.patientName,$(a).empty(),$(a).append('\n<option class="booked" disabled value="'.concat(book,'" ').concat(v.eventStatus==book?"selected":"",'>Booked</option>\n<option value="').concat(checkIn,'" ').concat(v.eventStatus==checkIn?"selected":""," ").concat(v.eventStatus==checkIn?"selected":""," \n    ").concat(v.eventStatus==cancel||v.eventStatus==checkOut?"disabled":"",'>Check In</option>\n<option value="').concat(checkOut,'" ').concat(v.eventStatus==checkOut?"selected":""," \n    ").concat(v.eventStatus==cancel||v.eventStatus==book?"disabled":"",'>Check Out</option>\n<option value="').concat(cancel,'" ').concat(v.eventStatus==cancel?"selected":""," ").concat(v.eventStatus==checkIn?"disabled":"","\n   ").concat(v.eventStatus==checkOut?"disabled":"",">Cancelled</option>\n")),$(a).val(v.eventStatus).trigger("change"),u.innerText=addCommas(v.amount),i.innerText=v.uId,s.innerText=v.service};$(document).on("change","#changeAppointmentStatus",(function(){if(!$(this).val())return!1;var e=$(this).val(),n=v.id;if(parseInt(e)===v.eventStatus)return!1;$.ajax({url:route("change-status",n),type:"POST",data:{appointmentId:n,appointmentStatus:e},success:function(e){displaySuccessMessage(e.message),$("#eventModal").modal("hide"),t.refetchEvents()}})}))})();