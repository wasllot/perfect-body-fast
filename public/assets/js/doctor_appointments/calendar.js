(()=>{"use strict";var e,t,n,a,o,s,d,r,c,i,u=!1,l={id:"",uId:"",eventName:"",eventDescription:"",eventStatus:"",startDate:"",endDate:"",amount:0,service:"",patientName:""};$(document).ready((function(){v(),m()}));var v=function(){var e=document.getElementById("appointmentCalendar");(t=new FullCalendar.Calendar(e,{navLinks:!0,selectable:!0,selectMirror:!0,editable:!1,dayMaxEvents:!0,displayEventTime:!1,buttonText:{month:"Month"},headerToolbar:{left:"prev,next",center:"title",right:"dayGridMonth"},events:function(e,t,n){$.ajax({url:route("doctors.appointments.calendar"),type:"GET",data:e,success:function(e){e.success&&t(e.data)},error:function(e){displayErrorMessage(e.responseJSON.message),n()}})},eventMouseEnter:function(e){p({id:e.event.id,title:e.event.title,startStr:e.event.startStr,endStr:e.event.endStr,description:e.event.extendedProps.description,status:e.event.extendedProps.status,amount:e.event.extendedProps.amount,uId:e.event.extendedProps.uId,service:e.event.extendedProps.service,patientName:e.event.extendedProps.patientName}),S(e.el)},eventMouseLeave:function(){f()},eventClick:function(e){f(),p({id:e.event.id,title:e.event.title,startStr:e.event.startStr,endStr:e.event.endStr,description:e.event.extendedProps.description,status:e.event.extendedProps.status,amount:e.event.extendedProps.amount,uId:e.event.extendedProps.uId,service:e.event.extendedProps.service,patientName:e.event.extendedProps.patientName}),h()}})).render()},m=function(){var e=document.getElementById("doctorAppointmentCalendarModal");d=new bootstrap.Modal(e),n=e.querySelector('[data-kt-calendar="event_name"]'),e.querySelector('[data-kt-calendar="event_description"]'),a=e.querySelector('[data-kt-calendar="event_status"]'),i=e.querySelector('[data-kt-calendar="event_amount"]'),c=e.querySelector('[data-kt-calendar="event_uId"]'),r=e.querySelector('[data-kt-calendar="event_service"]'),o=e.querySelector('[data-kt-calendar="event_start_date"]'),s=e.querySelector('[data-kt-calendar="event_end_date"]')},p=function(e){l.id=e.id,l.eventName=e.title,l.eventStatus=e.status,l.startDate=e.startStr,l.endDate=e.endStr,l.amount=e.amount,l.uId=e.uId,l.service=e.service,l.patientName=e.patientName},S=function(t){f();var n=l.allDay?moment(l.startDate).format("Do MMM, YYYY"):moment(l.startDate).format("Do MMM, YYYY - h:mm a"),a=l.allDay?moment(l.endDate).format("Do MMM, YYYY"):moment(l.endDate).format("Do MMM, YYYY - h:mm a"),o={container:"body",trigger:"manual",boundary:"window",placement:"auto",dismiss:!0,html:!0,title:"Appointment Details",content:'<div class="fw-bolder mb-2"><b>Patient:</b> '+l.patientName+'</div><div class="fs-7"><span class="fw-bold">Start:</span> '+n+'</div><div class="fs-7 mb-4"><span class="fw-bold">End:</span> '+a+"</div>"};(e=KTApp.initBootstrapPopover(t,o)).show(),u=!0},f=function(){u&&(e.dispose(),u=!1)},h=function(){var e,t;$(".fc-popover").addClass("hide"),d.show(),e=moment(l.startDate).format("Do MMM, YYYY - h:mm a"),t=moment(l.endDate).format("Do MMM, YYYY - h:mm a"),s.innerText=": "+t,o.innerText=": "+e,n.innerText="Patient: "+l.patientName,$(a).empty(),$(a).append('\n<option class="booked" disabled value="'.concat(book,'" ').concat(l.eventStatus==book?"selected":"",'>Booked</option>\n<option value="').concat(checkIn,'" ').concat(l.eventStatus==checkIn?"selected":""," ").concat(l.eventStatus==checkIn?"selected":""," \n    ").concat(l.eventStatus==cancel||l.eventStatus==checkOut?"disabled":"",'>Check In</option>\n<option value="').concat(checkOut,'" ').concat(l.eventStatus==checkOut?"selected":""," \n    ").concat(l.eventStatus==cancel||l.eventStatus==book?"disabled":"",'>Check Out</option>\n<option value="').concat(cancel,'" ').concat(l.eventStatus==cancel?"selected":""," ").concat(l.eventStatus==checkIn?"disabled":"","\n   ").concat(l.eventStatus==checkOut?"disabled":"",">Cancelled</option>\n")),$(a).val(l.eventStatus).trigger("change"),i.innerText=addCommas(l.amount),c.innerText=l.uId,r.innerText=l.service};$(document).on("change",".status-change",(function(){if(!$(this).val())return!1;var e=$(this).val(),n=l.id;if(parseInt(e)===l.eventStatus)return!1;$.ajax({url:route("doctors.change-status",n),type:"POST",data:{appointmentId:n,appointmentStatus:e},success:function(e){displaySuccessMessage(e.message),$("#doctorAppointmentCalendarModal").modal("hide"),t.refetchEvents()}})}))})();